#!/bin/bash

selected=$(find -L ~/.config -mindepth 1 -maxdepth 1 -type d \
  |fzf --with-nth=-1 --delimiter / --reverse --preview 'ls {}')

if [[ -z $selected ]]; then
  exit 0
fi

window_name=$(basename $selected | tr "." "_")

selectfile=$(find -L $selected -mindepth 1 -maxdepth 1 \
  | fzf --with-nth=-1 --delimiter / --reverse --preview "cat {}")

if [[ -z $selectfile ]]; then
  exit 0
fi

if [[ -z $TMUX ]]; then
  nvim $selectfile
else
  tmux neww -n $window_name nvim $selectfile
fi

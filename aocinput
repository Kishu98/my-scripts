#!/bin/bash

# Check if the session cookie is provided
session=$(cat $HOME/Documents/Personal/aoc_session.txt)
if [ -z "$session" ]; then
  echo "Usage: $0 <session_cookie>"
  exit 1
fi

# Get the current working directory
cwd=$(pwd)

# Extract the year and day from the directory path
if [[ $cwd =~ AdventOfCode/([0-9]{4})/([0-9]{2}) ]]; then
  year=${BASH_REMATCH[1]}
  day=${BASH_REMATCH[2]}
else
  echo "Could not determine year and day from the current directory."
  echo "Please make sure you are in a directory like '.../AdventOfCode/YYYY/DD'"
  exit 1
fi

# URL for the input
url="https://adventofcode.com/$year/day/$(echo $day | sed 's/^0*//')/input"

# Output file
output_file="Input.txt"

# Download the input using curl
echo "Fetching input for Year $year, Day $day..."
curl -s -b "session=$session" "$url" -o "$output_file"

if [ $? -eq 0 ]; then
  echo "Input saved to $output_file"
else
  echo "Failed to download input."
fi
